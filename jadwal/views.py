from django.shortcuts import render
from django.views.generic.base import TemplateView
from django.core.files.storage import FileSystemStorage

class IndexView(TemplateView):
    template_name='jadwal/index.html'

class TentukanView(TemplateView):
    template_name='jadwal/tentukan.html'

class HasilView(TemplateView):
    template_name='jadwal/hasil.html'

    def get_context_data(self):
        # hari = ['Senin', 'Rabu', 'Jumat']
        # ruangan = ['101', '102', '103', '304', '305', '306']
        # hasils = {
        #     'Senin' : {
        #         '101' : [24, 107, 32, 128, 131, 72, 54, 96, 0, 0],
        #         '102' : [89, 126, 41, 100, 103, 138, 0, 0, 0, 29, 125],
        #         '103' : [171, 90, 77, 142, 0, 0, 47, 1, 13, 94],
        #         '305' : [167, 151, 139, 168, 6, 169, 65, 124, 113, 160, 141],
        #         '306' : [33, 10, 79, 49, 116, 0, 0, 0, 87, 0]
        #     },
        #     'Rabu' : {
        #         '101' : [0, 4, 80, 15, 136, 95, 62, 38, 108, 91],
        #         '102' : [132, 119, 166, 130, 118, 133, 84, 19, 21],
        #         '304' : [55, 56, 14, 144, 174, 104, 145, 149, 88, 69, 117],
        #         '305' : [9, 150, 175, 30, 81, 39, 137, 86, 92, 146]
        #     },
        #     'Jumat' : {
        #         '101' : [127, 74, 156, 26, 57, 0, 0, 129, 0, 0, 43],
        #         '102' : [61, 27, 48, 78, 0, 0, 0, 0, 152, 143, 105],
        #         '305' : [5, 44, 35, 53, 162, 58, 147, 0, 0, 0],
        #         '306' : [0, 8, 70, 155, 0, 0, 0, 122, 173, 106, 135]
        #     }
        # }
        hasils = {
            'Senin' : {
                '101' : [
                    ['Bahasa Arab', 2, 'Moh. Nadhif', 'PGMI', 'A'],
                    ['', 1, '', '', ''],
                    ['Takhrijul Hadits', 2, 'Damanhuri', 'PAI', 'A'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ],
                '102' : [
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['IAD & ABD', 2, 'Misbahul Munir', 'PAI', 'A'],
                    ['', 1, '', '', '']
                ],
                '103' : [
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['Pancasila', 2, 'Ali Rifan', 'PAI', 'A'],
                    ['Studi Al-Quran', 2, 'Mokhamat Nafi', 'MPI', 'A'],
                    ['', 1, '', '', '']
                ],
                '305' : [
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['Bahasa Indonesia', 2, 'Handoko', 'MPI', 'A'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ],
                '306' : [
                    ['Takhrijul Hadits', 2, 'Damanhuri', 'PAI', 'B'],
                    ['Ushul Fiqih', 2, 'Kasuwi Saiban', 'MPI', 'A'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ]
            },
            'Rabu' : {
                '101' : [
                    ['', 1, '', '', ''],
                    ['Bahasa Indonesia', 2, 'Handoko', 'PAI', 'A'],
                    ['', 1, '', '', ''],
                    ['Bahasa Inggris', 2, 'Hilman Wajdi', 'PAI', 'A'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ],
                '102' : [
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['Qowaidul Fiqih', 3, 'Zaenu Zuhdi', 'PAI', 'A'],
                    ['Bahasa Arab', 2, 'Moh. Nadhif', 'PAI', 'A']
                ],
                '304' : [
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['Studi Al-Quran', 2, 'Mokhamat Nafi', 'PGMI', 'A'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ],
                '305' : [
                    ['Ushul Fiqih', 2, 'Kasuwi Saiban', 'PAI', 'B'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['IAD & IBD', 2, 'Misbahul Munir', 'PAI', 'B'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ]
            },
            'Jumat' : {
                '101' : [
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['Pengantar Studi Islam', 2, 'Umi Salamah', 'PAI', 'B'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ],
                '102' : [
                    ['', 1, '', '', ''],
                    ['Pengantar Studi Islam', 2, 'Umi Salamah', 'MPI', 'A'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ],
                '305' : [
                    ['Bahasa Indonesia', 2, 'Handoko', 'PAI', 'B'],
                    ['', 1, '', '', ''],
                    ['Takhrijul Hadits', 2, 'Damanhuri', 'PAI', 'B'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ],
                '306' : [
                    ['', 1, '', '', ''],
                    ['Ushul Fiqih', 2, 'Kasuwi Saiban', 'PAI', 'A'],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', ''],
                    ['', 1, '', '', '']
                ]
            }
        }

        context = {
            'hasils'  : hasils
        }
        # data = zip(hari, ruangan, hasils)
        # for hasil in hasils:
        #     data2 = [old + (new,) for old, new in zip(data, hasil)]
        # context = {
        #     'data' : data,
            # 'data2' : data2,
        # }

        return context

def importExcel(request):
    if request.method == 'POST':
        uploaded_file = request.FILES['jadwal']
        fs = FileSystemStorage()
        fs.save(uploaded_file.name, uploaded_file)
    return render(request, 'jadwal/import_excel.html')